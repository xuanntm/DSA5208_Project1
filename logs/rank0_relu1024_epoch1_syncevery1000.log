2025-09-27 21:25:03,619 - INFO - MPI world size: 8
2025-09-27 21:25:03,619 - INFO - Loading dataset from: $data/output/split_data
2025-09-27 21:25:03,619 - INFO - file_by_rank: data/output/split_data/to_8/part_0.csv
2025-09-27 21:25:05,900 - INFO - [Rank 0] reads the CSV and keeps rows by rank took 2.2809 sec
2025-09-27 21:25:06,613 - INFO - Length train_local: $3240444 test_local: $1388762
2025-09-27 21:25:06,613 - INFO - [Rank 0] split_for_training took 0.7129 sec
2025-09-27 21:25:07,067 - INFO - [Rank 0] normalize_train_test took 0.4116 sec
2025-09-27 21:25:07,067 - INFO - broadcast stats, X_cols, target to all ranks
2025-09-27 21:25:08,039 - INFO - apply normalization parameters to local partitions
2025-09-27 21:25:08,345 - INFO - Prepare local arrays
2025-09-27 21:25:08,652 - INFO - N_train_local 3240444
2025-09-27 21:25:08,963 - INFO - Global train size: 25923545, local sizes: 3240444
2025-09-27 21:25:09,038 - INFO - ========== Epoch 0 START
2025-09-27 21:25:12,900 - INFO - [Rank 0] Iter    310, epoch 0, local R(θ)=12.377288
2025-09-27 21:25:23,214 - INFO - [Rank 0] Iter    620, epoch 0, local R(θ)=10.239742
2025-09-27 21:25:30,716 - INFO - [Rank 0] Iter    930, epoch 0, local R(θ)=9.263220
2025-09-27 21:25:31,072 - INFO - Epoch 0 sync and update model
2025-09-27 21:25:38,514 - INFO - [Rank 0] Iter   1240, epoch 0, local R(θ)=10.034091
2025-09-27 21:25:45,275 - INFO - [Rank 0] Iter   1550, epoch 0, local R(θ)=9.296381
2025-09-27 21:25:50,981 - INFO - [Rank 0] Iter   1860, epoch 0, local R(θ)=8.809292
2025-09-27 21:25:51,115 - INFO - Epoch 0 sync and update model
2025-09-27 21:25:59,471 - INFO - [Rank 0] Iter   2170, epoch 0, local R(θ)=8.447509
2025-09-27 21:26:08,947 - INFO - [Rank 0] Iter   2480, epoch 0, local R(θ)=8.167015
2025-09-27 21:26:16,126 - INFO - [Rank 0] Iter   2790, epoch 0, local R(θ)=7.972292
2025-09-27 21:26:16,865 - INFO - Epoch 0 sync and update model
2025-09-27 21:26:26,486 - INFO - [Rank 0] Iter   3100, epoch 0, local R(θ)=7.828000
2025-09-27 21:26:34,353 - INFO - Epoch 0 END, R(θ)=7.845782
2025-09-27 21:26:34,356 - INFO - [Rank 0] ========Training Loop===== took 85.3933 sec
2025-09-27 21:26:47,353 - INFO - 
Training finished
2025-09-27 21:26:47,356 - INFO - Namespace(data='data/output/split_data', epochs=1, batch_size=1024, hidden=64, lr=0.002, activation='relu', seed=123, sync_every=1000, print_every=310, save_model='data/output/model/')
2025-09-27 21:26:47,356 - INFO - Epochs: 1, total iters: 3165
2025-09-27 21:26:47,356 - INFO - Training time (s): 85.395
2025-09-27 21:26:47,356 - INFO - RMSE train: 3.961258
2025-09-27 21:26:47,356 - INFO - RMSE test:  3.968538
2025-09-27 21:26:47,424 - INFO - Saved model to data/output/model/
2025-09-27 21:26:47,424 - INFO - [Rank 0] compute final RMSE on train and test in parallel took 13.0673 sec
2025-09-27 21:26:47,448 - INFO - 
Sample test predictions:
2025-09-27 21:26:47,452 - INFO - Features: [ 0.33675675 -0.047931    0.95787755  1.44044522 -0.43222795 -1.03536767
 -1.6781407  -0.4258944   2.86635465  0.22209333  1.6781407   0.50613722
 -0.49910154 -0.06728904  0.48432981 -0.44977276]
2025-09-27 21:26:47,452 - INFO -  Predicted total_amount: 29.83
2025-09-27 21:26:47,452 - INFO -  Actual total_amount:    31.56

2025-09-27 21:26:47,452 - INFO - Features: [-0.34680691 -0.83493607 -0.40495913  1.44044522 -0.43222795 -1.03536767
  0.59589741 -0.4258944  -0.34887507  0.22209333 -0.59589741  0.50613722
 -0.49910154 -0.06728904 -1.32605002  0.53209603]
2025-09-27 21:26:47,453 - INFO -  Predicted total_amount: 15.60
2025-09-27 21:26:47,453 - INFO -  Actual total_amount:    13.30

2025-09-27 21:26:47,453 - INFO - Features: [-0.4064467  -0.83493607 -0.59316674  1.44044522 -0.43222795 -1.03536767
  0.59589741 -0.4258944  -0.34887507  0.22209333 -0.59589741  0.50613722
 -0.49910154 -0.06728904  0.48432981 -0.44977276]
2025-09-27 21:26:47,453 - INFO -  Predicted total_amount: 14.18
2025-09-27 21:26:47,453 - INFO -  Actual total_amount:    13.56

2025-09-27 21:26:47,634 - INFO - [Rank 0] run training took 104.0165 sec
2025-09-27 21:26:47,638 - INFO - Saved training history.csv
